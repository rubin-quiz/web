<!DOCTYPE html>
<html lang="ja">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y48G5L07GS"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-Y48G5L07GS');
    </script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "r7f6b82xga");
    </script>
    <title>ルビンの思うつぼ</title>
    <meta name="description" content="知っていると日常がちょっとだけ楽しくなるような雑学を発信していきます。様々なジャンルの知識についてクイズを通して楽しく学ぶことで日常に興を添えるウェブサイトです。">
    <meta property="og:title" content="ルビンの思うつぼ">
    <meta property="og:description" content="知っていると日常がちょっとだけ楽しくなるような雑学を発信していきます。様々なジャンルの知識についてクイズを通して楽しく学ぶことで日常に興を添えるウェブサイトです。">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://rubin-quiz.github.io/web/">
    <meta property="og:image" content="https://rubin-quiz.github.io/web/images/rubin_logo_main.png">
    <link rel="icon" href="./images/rubin_logo_main.png" type="image/x-icon">
    <link rel="stylesheet" href="https://unpkg.com/ress@4.0.0/dist/ress.min.css">
    <link rel="stylesheet" href="./index.css" />
    <script src="./index.js"></script>
</head>

<body>
    <!-- ヘッダーを外部ファイルから読み込む -->
    <header>
        <script>
            fetch("header.html")
                .then(response => response.text())
                .then(data => document.querySelector("header").innerHTML = data)
                .catch(() => { document.querySelector("header").innerHTML = '<div class="header__fallback">ヘッダーの読み込みに失敗しました</div>'; });
        </script>
    </header>

    <main>
        <div class="banner">
            <img src="./images/bannar0.webp" alt="ルビンの思うつぼ サイトバナー" loading="eager">
            <div class="vertical-text">
                <span class="char">知</span>
                <span class="char">識</span>
                <span class="char">で</span><br>
                <span class="char">　</span>
                <span class="char">日</span>
                <span class="char">常</span>
                <span class="char">に</span>
                <span class="char">興</span>
                <span class="char">を</span>
            </div>
        </div>

        <div class="main-wrapper">
            <!-- 左広告 -->
            <div class="side-ad">
                <!-- admax -->
                <div class="admax-ads" data-admax-id="29ad01e887deb41d0e0625f170e9ea42"
                    style="display:inline-block;width:160px;height:600px;"></div>
                <script
                    type="text/javascript">(admaxads = window.admaxads || []).push({ admax_id: "29ad01e887deb41d0e0625f170e9ea42", type: "banner" });</script>
                <script type="text/javascript" charset="utf-8" src="https://adm.shinobi.jp/st/t.js" async></script>
                <!-- admax -->
            </div>

            <div class="main-content">
                <div class="content">
                    <h2 class="title">New Quiz</h2>
                    <div id="quiz-container">
                        <div class="quiz-item">
                            <div class="quiz-question">読み込み中...</div>
                        </div>
                    </div>
                    <a href="quiz.html">過去のQuizはこちら</a>
                </div>
                
                <div class="content">
                    <h2 class="title">Latest News</h2>
                    <div class="article">
                        <div class="latestnews">
                            <div class="news-container" id="latest-news-container">
                                <table>
                                    <tr>
                                        <td style="border-bottom: 0px;" colspan="3">読み込み中...</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <a href="news.html">過去のNewsはこちら</a>
                    </div>
                </div>
                
                <script>
                    // quiz.jsから最新のクイズを取得する関数
                    async function loadLatestQuiz() {
                        try {
                            const response = await fetch('quiz.js');
                            const jsText = await response.text();
                            
                            // quizDataの配列部分を抽出
                            const quizDataMatch = jsText.match(/const quizData = \[([\s\S]*?)\];/);
                            if (!quizDataMatch) {
                                throw new Error('クイズデータが見つかりませんでした');
                            }
                            
                            // 配列の中身を評価して取得（evalの代わりにFunction constructorを使用）
                            const quizArray = new Function('return [' + quizDataMatch[1] + '];')();
                            
                            // 最初のクイズ（最新）を取得
                            const latestQuiz = quizArray[0];
                            
                            // クイズHTMLを生成
                            const quizContainer = document.getElementById('quiz-container');
                            quizContainer.innerHTML = `
                                <div class="quiz-item">
                                    <div class="quiz-question">
                                        ${latestQuiz.question}
                                    </div>
                                    <div class="quiz-footer">
                                        <div class="answer-toggle" onclick="toggleAnswer(this)">
                                            <span class="toggle-icon">+</span>
                                            <span class="toggle-text">回答を表示</span>
                                        </div>
                                        <div class="quiz-categories">
                                            ${latestQuiz.categories.map(cat => 
                                                `<span class="quiz-category">${cat}</span>`
                                            ).join('')}
                                        </div>
                                    </div>
                                    <div class="answer" style="display: none;">
                                        ${latestQuiz.answer}
                                        ${latestQuiz.supplement ? `<div class="supplement">${latestQuiz.supplement}</div>` : ''}
                                    </div>
                                </div>
                            `;
                        } catch (error) {
                            console.error('クイズの読み込みに失敗しました:', error);
                            document.getElementById('quiz-container').innerHTML = `
                                <div class="quiz-item">
                                    <div class="quiz-question">クイズの読み込みに失敗しました</div>
                                </div>
                            `;
                        }
                    }
                    
                    // news.htmlから最新ニュースを取得する関数
                    async function loadLatestNews() {
                        try {
                            const response = await fetch('news.html');
                            const html = await response.text();
                            
                            // DOMパーサーを使用してHTMLを解析
                            const parser = new DOMParser();
                            const doc = parser.parseFromString(html, 'text/html');
                            
                            // news.htmlのテーブルの最初の行（最新ニュース）を取得
                            const newsTable = doc.querySelector('.news-container table tbody');
                            const latestNewsRow = newsTable.querySelector('tr');
                            
                            if (latestNewsRow) {
                                // 取得した行をindex.htmlに挿入
                                const container = document.getElementById('latest-news-container');
                                const table = container.querySelector('table');
                                
                                // 各tdにstyle="border-bottom: 0px;"を追加
                                const clonedRow = latestNewsRow.cloneNode(true);
                                clonedRow.querySelectorAll('td').forEach(td => {
                                    td.style.borderBottom = '0px';
                                });
                                
                                table.innerHTML = clonedRow.outerHTML;
                            } else {
                                throw new Error('ニュースが見つかりませんでした');
                            }
                        } catch (error) {
                            console.error('ニュースの読み込みに失敗しました:', error);
                            const container = document.getElementById('latest-news-container');
                            container.querySelector('table').innerHTML = `
                                <tr>
                                    <td style="border-bottom: 0px;" colspan="3">ニュースの読み込みに失敗しました</td>
                                </tr>
                            `;
                        }
                    }
                    
                    // 回答の表示/非表示を切り替える関数（既存のindex.jsにあれば不要）
                    function toggleAnswer(element) {
    const quizItem = element.closest('.quiz-item');
    const answer = quizItem.querySelector('.answer');
    const toggleIcon = element.querySelector('.toggle-icon');
    const toggleText = element.querySelector('.toggle-text');
    
    if (answer.style.maxHeight && answer.style.maxHeight !== '0px') {
        // 閉じる
        answer.style.maxHeight = '0px';
        answer.style.opacity = '0';
        answer.style.paddingTop = '0';
        answer.style.paddingBottom = '0';
        answer.style.marginTop = '0';
        
        toggleIcon.textContent = '+';
        toggleText.textContent = '回答を表示';
        element.classList.remove('active');
    } else {
        // 開く
        answer.style.display = 'block';
        answer.style.overflow = 'hidden';
        answer.style.transition = 'max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1), padding 0.5s cubic-bezier(0.4, 0, 0.2, 1), margin 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
        answer.style.maxHeight = '0px';
        answer.style.opacity = '0';
        answer.style.paddingTop = '0';
        answer.style.paddingBottom = '0';
        answer.style.marginTop = '0';
        
        // 高さを計算
        requestAnimationFrame(() => {
            answer.style.maxHeight = answer.scrollHeight + 50 + 'px';
            answer.style.opacity = '1';
            answer.style.paddingTop = '';
            answer.style.paddingBottom = '';
            answer.style.marginTop = '';
        });
        
        toggleIcon.textContent = '−';
        toggleText.textContent = '回答を隠す';
        element.classList.add('active');
    }
}
                    
                    // ページ読み込み時に実行
                    window.addEventListener('DOMContentLoaded', () => {
                        loadLatestQuiz();
                        loadLatestNews();
                    });
                    </script>
            </div>

            <!-- 右広告 -->
            <div class="side-ad">
                <!-- admax -->
                <div class="admax-ads" data-admax-id="9de2abbf15a090fe932d5f5b915939ba"
                    style="display:inline-block;width:160px;height:600px;"></div>
                <script
                    type="text/javascript">(admaxads = window.admaxads || []).push({ admax_id: "9de2abbf15a090fe932d5f5b915939ba", type: "banner" });</script>
                <script type="text/javascript" charset="utf-8" src="https://adm.shinobi.jp/st/t.js" async></script>
                <!-- admax -->
            </div>

        </div>

        <!-- バナー広告 -->
        <div class="banner-ad">
            <!-- admax -->
            <div class="admax-ads" data-admax-id="9ee7b8b1c8e091021dff3909436eaeab" style="display:inline-block;"></div>
            <script
                type="text/javascript">(admaxads = window.admaxads || []).push({ admax_id: "9ee7b8b1c8e091021dff3909436eaeab", type: "banner" });</script>
            <script type="text/javascript" charset="utf-8" src="https://adm.shinobi.jp/st/t.js" async></script>
            <!-- admax -->
        </div>

    </main>
    <!-- フッターを外部ファイルから読み込む -->
    <footer>
        <script>
            fetch("footer.html")
                .then(response => response.text())
                .then(data => document.querySelector("footer").innerHTML = data)
                .catch(() => { document.querySelector("footer").innerHTML = '<div class="footer__list__center"><small>フッターの読み込みに失敗しました</small></div>'; });
        </script>
    </footer>
</body>

</html>